<!-- Copyright Vespa.ai. All rights reserved. -->
{% assign h2_count = content | split: '<h' | size | minus: 1 %}
    {% if h2_count > 4 %}

    {% if page.title == 'FAQ - frequently asked questions'%} 
    <style>
    /* Fixed widths per heading level */
    .toc ul .toc-level-0 > a {
        width: 100% !important;
    }
    
    .toc ul .toc-level-1 > a {
      width: 90% !important;
    }
    
    .toc ul .toc-level-2 > a {
      width: 80% !important;
    }
    </style>
    {% endif %}

<nav class="toc" aria-labelledby="on-this-page-heading" style="position: fixed; align-self: flex-start;">
    <h3 class="row" style="pointer-events: none;">On this page:</h3>
    {% assign headings = content | split: '<' %}
    
    <ul style=" z-index: 3; max-height: 80vh; overflow-y: auto;">
          {% for tag in headings %}
          {% assign tag_slice = tag | slice: 0, 1%}
          {% if tag_slice == '/' %}
            {% continue %}
          {% else %}
          {% assign tag_start = tag | slice: 0, 3 %}
          {% if tag_start == 'h1 ' or tag_start == 'h2 ' or tag_start == 'h3 ' or tag_start == 'h1>' or tag_start == 'h2>' or tag_start == 'h3>' %}          
              {% assign toc_level = tag | slice: 1, 2%}
              {% assign parts = tag | split: '>' %}
              {% assign heading_id_first_cut = parts[0] | split: 'id="' %}
              {% assign heading_id_second_cut = heading_id_first_cut[1] | split: '"' %}
              {% assign heading_id = heading_id_second_cut[0] | strip | lstrip %}
              {% assign heading_text = parts[1] | strip | lstrip %}
  
              {% if heading_text != "" %}
              <li class="toc-level-{{toc_level | minus: 1 }}">
                <a href="#{{ heading_id }}">{{ heading_text }}</a>
              </li>
          {% endif %}
            {% endif %}
          {% endif %}
          {% endfor %}
  
    </ul>
  </div>
  
{% endif %}
  